---
layout: post
title:  "Windows内核十三、win7的新特性"
date:   2018/10/4 23:00:00
categories: 内核
tag: 
---

# DSE

即驱动强制签名，这个签名要找微软买。这里有一个dseo13b的工具，可以签上测试签名，并且可以打开测试模式使DSE失效。

# KPP

即内核补丁保护。会有代码检测关键内核是否被修改，如果修改则蓝屏。例如xp下可以HookSSDT，但win7下如果Hook就会蓝屏。所以win7如果想HookSSDT都是使用InlineHook了。

# win7下的各种表

GDT、IDT都是48位地址了，表的内容都是128位了。内核中的结构体例如_EPROCESS等等也扩展更多字段。SSDT表加密了，需要将表中的内容的函数地址左移4位再加上模块首地址。因为其只使用了64位保存，故就算过了KPP也只能将其指向很小的偏移，而不能跳到整个内存。

